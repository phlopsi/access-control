<?xml version="1.0" encoding="UTF-8"?>
<database
    name="access_control"
    defaultIdMethod="native"
    namespace="org\bitbucket\phlopsi\access_control\propel"
>
    <behavior name="auto_add_pk" />
    <table name="permissions" phpName="Permission">
        <column name="external_id" type="longvarchar" required="true" />
        <behavior name="nested_set" />
    </table>
    <table name="permissions_roles">
        <column name="permissions_id" phpName="permissionId" type="integer" required="true" primaryKey="true" />
        <column name="roles_id" phpName="roleId" type="integer" required="true" primaryKey="true" />
        <foreign-key foreignTable="permissions">
            <reference local="permissions_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="roles">
            <reference local="roles_id" foreign="id" />
        </foreign-key>
    </table>
    <table name="prohibitions" phpName="Permission">
        <column name="external_id" type="longvarchar" required="true" />
        <behavior name="nested_set" />
    </table>
    <table name="prohibitions_roles">
        <column name="prohibitions_id" phpName="prohibitionId" type="integer" required="true" primaryKey="true" />
        <column name="roles_id" phpName="roleId" type="integer" required="true" primaryKey="true" />
        <foreign-key foreignTable="prohibitions">
            <reference local="prohibitions_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="roles">
            <reference local="roles_id" foreign="id" />
        </foreign-key>
    </table>
    <table name="prohibitions_users">
        <column name="prohibitions_id" phpName="prohibitionId" type="integer" required="true" primaryKey="true" />
        <column name="users_id" phpName="userId" type="integer" required="true" primaryKey="true" />
        <column name="prohibited_until" type="timestamp" />
        <behavior name="timestampable" />
        <foreign-key foreignTable="prohibitions">
            <reference local="prohibitions_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="users">
            <reference local="users_id" foreign="id" />
        </foreign-key>
    </table>
    <table name="roles" phpName="Role">
        <column name="external_id" type="longvarchar" required="true" />
        <behavior name="nested_set" />
    </table>
    <table name="roles_session_types">
        <column name="roles_id" phpName="roleId" type="integer" required="true" primaryKey="true" />
        <column name="session_types_id" phpName="sessionTypeId" type="integer" required="true" primaryKey="true" />
        <foreign-key foreignTable="roles">
            <reference local="roles_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="session_types">
            <reference local="session_types_id" foreign="id" />
        </foreign-key>
    </table>
    <table name="roles_users">
        <column name="roles_id" phpName="roleId" type="integer" required="true" primaryKey="true" />
        <column name="users_id" phpName="userId" type="integer" required="true" primaryKey="true" />
        <foreign-key foreignTable="roles">
            <reference local="roles_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="users">
            <reference local="users_id" foreign="id" />
        </foreign-key>
    </table>
    <table name="session_types" phpName="SessionType">
        <column name="external_id" type="longvarchar" required="true" />
        <behavior name="nested_set" />
    </table>
    <table name="sessions">
        <column name="session_types_id" phpName="sessionTypeId" type="integer" required="true" />
        <column name="users_id" phpName="userId" type="integer" required="true" />
        <column name="key" type="varchar" size="127" required="true" primaryKey="true" />
        <column name="session_duration" type="timestamp" />
        <column name="simulated_users_id" phpName="simulatedUserId" type="integer" />
        <behavior name="timestampable" />
        <foreign-key foreignTable="session_types">
            <reference local="session_types_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="users">
            <reference local="users_id" foreign="id" />
            <reference local="simulated_users_id" foreign="id" />
        </foreign-key>
    </table>
    <table name="users" phpName="User">
        <column name="external_id" type="longvarchar" required="true" />
    </table>
</database>